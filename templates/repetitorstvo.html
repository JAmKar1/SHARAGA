<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–µ—Ö–Ω–∏–∫—É–º - –†–µ–ø–µ—Ç–∏—Ç–æ—Ä—Å—Ç–≤–æ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: #f5f5f5;
            min-height: 100vh;
        }

        .header {
            background: linear-gradient(135deg, #1a237e 0%, #283593 100%);
            color: white;
            padding: 15px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .logo {
            font-size: 24px;
            font-weight: 700;
        }

        .nav-links {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .nav-link {
            color: white;
            text-decoration: none;
            padding: 8px 15px;
            border-radius: 5px;
            transition: background-color 0.3s;
        }

        .nav-link:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }

        .nav-link.active {
            background-color: rgba(255, 255, 255, 0.2);
        }

        .back-btn {
            background-color: rgba(255, 255, 255, 0.2);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.3);
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            text-decoration: none;
            transition: background-color 0.3s;
        }

        .back-btn:hover {
            background-color: rgba(255, 255, 255, 0.3);
        }

        .content {
            max-width: 1200px;
            margin: 30px auto;
            padding: 0 20px;
        }

        .page-header {
            margin-bottom: 30px;
            text-align: center;
        }

        .page-header h1 {
            color: #283593;
            margin-bottom: 10px;
            font-size: 32px;
        }

        .page-header p {
            color: #666;
            font-size: 18px;
        }

        .section-container {
            background-color: white;
            border-radius: 10px;
            padding: 25px;
            box-shadow: 0 3px 15px rgba(0, 0, 0, 0.08);
            margin-bottom: 30px;
        }

        .section-title {
            color: #283593;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #eee;
            font-size: 22px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .tutoring-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 20px;
        }

        .tutoring-card {
            background-color: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.08);
            border-left: 4px solid;
            transition: transform 0.3s, box-shadow 0.3s;
            display: flex;
            flex-direction: column;
        }

        .tutoring-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .teacher-card {
            border-left-color: #2196F3;
        }

        .student-card {
            border-left-color: #4CAF50;
        }

        .tutoring-subject {
            font-size: 20px;
            font-weight: 600;
            color: #283593;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .tutoring-tutor {
            color: #666;
            margin-bottom: 15px;
            font-size: 16px;
        }

        .tutoring-info {
            margin-top: 15px;
            font-size: 14px;
            flex-grow: 1;
        }

        .tutoring-info p {
            margin: 8px 0;
            color: #555;
            display: flex;
            align-items: flex-start;
        }

        .tutoring-info strong {
            color: #333;
            min-width: 100px;
            display: inline-block;
        }

        /* –ö–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π */
        .tutoring-actions {
            margin-top: 20px;
            padding-top: 15px;
            border-top: 1px solid #eee;
            display: flex;
            gap: 10px;
        }

        .btn {
            display: inline-block;
            padding: 10px 20px;
            border-radius: 5px;
            text-decoration: none;
            font-weight: bold;
            transition: all 0.3s;
            border: none;
            cursor: pointer;
            font-size: 14px;
            text-align: center;
            flex: 1;
        }

        .btn-register {
            background-color: #4CAF50;
            color: white;
        }

        .btn-register:hover {
            background-color: #45a049;
        }

        .btn-register:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
        }

        .btn-view {
            background-color: #2196F3;
            color: white;
        }

        .btn-view:hover {
            background-color: #1976D2;
        }

        .btn-already-registered {
            background-color: #FF9800;
            color: white;
            cursor: default;
        }

        .empty-message {
            text-align: center;
            color: #999;
            padding: 40px 20px;
            font-size: 16px;
            background-color: #f9f9f9;
            border-radius: 8px;
            margin: 20px 0;
            border: 2px dashed #ddd;
        }

        .status-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 15px;
            font-size: 12px;
            font-weight: 600;
        }

        .status-open {
            background-color: #4CAF50;
            color: white;
        }

        .status-closed {
            background-color: #f44336;
            color: white;
        }

        .status-full {
            background-color: #FF9800;
            color: white;
        }

        .info-box {
            background-color: #f0f7ff;
            border-radius: 10px;
            padding: 20px;
            margin-top: 30px;
            border-left: 4px solid #283593;
        }

        .info-box h3 {
            color: #283593;
            margin-bottom: 15px;
        }

        .info-box ul {
            padding-left: 20px;
            color: #555;
        }

        .info-box li {
            margin-bottom: 8px;
        }

        /* –ö–Ω–æ–ø–∫–∏ –≤–≤–µ—Ä—Ö—É —Å—Ç—Ä–∞–Ω–∏—Ü—ã */
        .page-actions {
            text-align: center;
            margin: 20px 0 30px 0;
        }

        .page-action-btn {
            display: inline-block;
            padding: 12px 24px;
            border-radius: 5px;
            text-decoration: none;
            font-weight: bold;
            margin: 10px;
            transition: background-color 0.3s;
            border: none;
            cursor: pointer;
            font-size: 14px;
            min-width: 200px;
        }

        .btn-add {
            background-color: #4CAF50;
            color: white;
        }

        .btn-add:hover {
            background-color: #45a049;
        }

        .btn-my {
            background-color: #2196F3;
            color: white;
        }

        .btn-my:hover {
            background-color: #1976D2;
        }

        /* –°—Ç–∏–ª—å –¥–ª—è —É–∂–µ –∑–∞–ø–∏—Å–∞–Ω–Ω—ã—Ö */
        .registered-info {
            background-color: #e8f5e9;
            border: 1px solid #4CAF50;
            border-radius: 5px;
            padding: 10px;
            margin-top: 10px;
            text-align: center;
            color: #2e7d32;
            font-weight: bold;
        }

        @media (max-width: 768px) {
            .header {
                padding: 15px 20px;
                flex-direction: column;
                gap: 10px;
            }

            .nav-links {
                flex-wrap: wrap;
                justify-content: center;
            }

            .tutoring-grid {
                grid-template-columns: 1fr;
            }

            .content {
                padding: 0 15px;
            }
            
            .page-header h1 {
                font-size: 26px;
            }

            .page-actions {
                display: flex;
                flex-direction: column;
                gap: 10px;
            }
            
            .page-action-btn {
                width: 100%;
                margin: 0;
            }
            
            .tutoring-actions {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="logo">–†–µ–ø–µ—Ç–∏—Ç–æ—Ä—Å—Ç–≤–æ</div>
        <div class="nav-links">
            <a href="/" class="nav-link">–ì–ª–∞–≤–Ω–∞—è</a>
            <a href="/repetitorstvo" class="nav-link active">–†–µ–ø–µ—Ç–∏—Ç–æ—Ä—Å—Ç–≤–æ</a>
            <a href="/raspisanie" class="nav-link">–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ</a>
            <a href="/logout" class="back-btn">–í—ã–π—Ç–∏</a>
        </div>
    </div>

    <div class="content">
        <div class="page-header">
            <h1>–†–µ–ø–µ—Ç–∏—Ç–æ—Ä—Å—Ç–≤–æ –≤ —Ç–µ—Ö–Ω–∏–∫—É–º–µ</h1>
            <p>–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–Ω—è—Ç–∏—è –æ—Ç –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–µ–π –∏ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤-—Å—Ç–∞—Ä—à–µ–∫—É—Ä—Å–Ω–∏–∫–æ–≤</p>
        </div>

        <!-- –ö–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π -->
        {% if user.user_type in ['teacher', 'student'] %}
        <div class="page-actions">
            <a href="/repetitorstvo/add" class="page-action-btn btn-add">
                ‚ûï –î–æ–±–∞–≤–∏—Ç—å —Å–≤–æ—ë —Ä–µ–ø–µ—Ç–∏—Ç–æ—Ä—Å—Ç–≤–æ
            </a>
            <a href="/repetitorstvo/my" class="page-action-btn btn-my">
                üìã –ú–æ–∏ —Ä–µ–ø–µ—Ç–∏—Ç–æ—Ä—Å—Ç–≤–∞
            </a>
        </div>
        {% endif %}

        <!-- –†–∞–∑–¥–µ–ª –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–µ–π -->
        <div class="section-container">
            <h2 class="section-title">üë®‚Äçüè´ –ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–∏</h2>
            
            {% if teachers and teachers|length > 0 %}
            <div class="tutoring-grid">
                {% for item in teachers %}
                <div class="tutoring-card teacher-card">
                    <div class="tutoring-subject">
                        {{ item.subject }}
                        {% if item.status == '–ò–¥–µ—Ç –Ω–∞–±–æ—Ä' %}
                        <span class="status-badge status-open">{{ item.status }}</span>
                        {% elif item.status == '–ù–∞–±–æ—Ä –∑–∞–∫—Ä—ã—Ç' %}
                        <span class="status-badge status-closed">{{ item.status }}</span>
                        {% else %}
                        <span class="status-badge status-full">{{ item.status }}</span>
                        {% endif %}
                    </div>
                    <div class="tutoring-tutor">
                        <strong>–ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å:</strong> {{ item.tutor_name }}
                    </div>
                    
                    <div class="tutoring-info">
                        <p><strong>üìÖ –î–Ω–∏:</strong> {{ item.days }}</p>
                        <p><strong>üïê –í—Ä–µ–º—è:</strong> {{ item.time }}</p>
                        <p><strong>üö™ –ê—É–¥–∏—Ç–æ—Ä–∏—è:</strong> {{ item.room }}</p>
                        <p><strong>üí∞ –°—Ç–æ–∏–º–æ—Å—Ç—å:</strong> {{ item.price }}</p>
                        <p><strong>üë• –ú–µ—Å—Ç–∞:</strong> {{ item.registered_count or 0 }}/{{ item.max_students }}</p>
                        
                        {% if item.students and item.students|length > 0 %}
                        <p><strong>–ó–∞–ø–∏—Å–∞–ª–∏—Å—å:</strong> 
                            {% for student in item.students %}
                                {{ student.name }}{% if student.status != '–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ' %} ({{ student.status }}){% endif %}{% if not loop.last %}, {% endif %}
                            {% endfor %}
                        </p>
                        {% endif %}
                    </div>
                    
                    <!-- –ü—Ä–æ–≤–µ—Ä–∫–∞, –∑–∞–ø–∏—Å–∞–Ω –ª–∏ —É–∂–µ —Ç–µ–∫—É—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å -->
                    {% set is_registered = false %}
                    {% if item.students %}
                        {% for student in item.students %}
                            {% if student.student_id == user.id %}
                                {% set is_registered = true %}
                            {% endif %}
                        {% endfor %}
                    {% endif %}
                    
                    <div class="tutoring-actions">
                        {% if user.user_type == 'student' %}
                            {% if is_registered %}
                                <div class="registered-info">
                                    ‚úÖ –í—ã —É–∂–µ –∑–∞–ø–∏—Å–∞–Ω—ã
                                </div>
                            {% elif item.status == '–ò–¥–µ—Ç –Ω–∞–±–æ—Ä' and (item.registered_count or 0) < item.max_students %}
                                <form action="/repetitorstvo/register/{{ item.id }}" method="POST">
                                    <button type="submit" class="btn btn-register">üìù –ó–∞–ø–∏—Å–∞—Ç—å—Å—è</button>
                                </form>
                            {% elif (item.registered_count or 0) >= item.max_students %}
                                <button class="btn btn-register" disabled>‚ùå –ù–µ—Ç –º–µ—Å—Ç</button>
                            {% elif item.status != '–ò–¥–µ—Ç –Ω–∞–±–æ—Ä' %}
                                <button class="btn btn-register" disabled>üö´ –ù–∞–±–æ—Ä –∑–∞–∫—Ä—ã—Ç</button>
                            {% endif %}
                        {% endif %}
                    </div>
                </div>
                {% endfor %}
            </div>
            {% else %}
            <div class="empty-message">
                üì≠ –°–µ–π—á–∞—Å –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∑–∞–Ω—è—Ç–∏–π –æ—Ç –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–µ–π
            </div>
            {% endif %}
        </div>

        <!-- –†–∞–∑–¥–µ–ª —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ -->
        <div class="section-container">
            <h2 class="section-title">üë®‚Äçüéì –°—Ç—É–¥–µ–Ω—Ç—ã-—Ä–µ–ø–µ—Ç–∏—Ç–æ—Ä—ã</h2>
            
            {% if students and students|length > 0 %}
            <div class="tutoring-grid">
                {% for item in students %}
                <div class="tutoring-card student-card">
                    <div class="tutoring-subject">
                        {{ item.subject }}
                        {% if item.status == '–ò–¥–µ—Ç –Ω–∞–±–æ—Ä' or item.status == '–ï—Å—Ç—å –º–µ—Å—Ç–∞' %}
                        <span class="status-badge status-open">{{ item.status }}</span>
                        {% elif item.status == '–ù–∞–±–æ—Ä –∑–∞–∫—Ä—ã—Ç' or item.status == '–ù–µ—Ç –º–µ—Å—Ç' %}
                        <span class="status-badge status-closed">{{ item.status }}</span>
                        {% else %}
                        <span class="status-badge status-full">{{ item.status }}</span>
                        {% endif %}
                    </div>
                    <div class="tutoring-tutor">
                        <strong>–°—Ç—É–¥–µ–Ω—Ç:</strong> {{ item.tutor_name }}
                    </div>
                    
                    <div class="tutoring-info">
                        <p><strong>üìÖ –î–Ω–∏:</strong> {{ item.days }}</p>
                        <p><strong>üïê –í—Ä–µ–º—è:</strong> {{ item.time }}</p>
                        <p><strong>üö™ –ú–µ—Å—Ç–æ:</strong> {{ item.room }}</p>
                        <p><strong>üí∞ –°—Ç–æ–∏–º–æ—Å—Ç—å:</strong> {{ item.price }}</p>
                        <p><strong>üë• –ú–µ—Å—Ç–∞:</strong> {{ item.registered_count or 0 }}/{{ item.max_students }}</p>
                        
                        {% if item.students and item.students|length > 0 %}
                        <p><strong>–ó–∞–ø–∏—Å–∞–ª–∏—Å—å:</strong> 
                            {% for student in item.students %}
                                {{ student.name }}{% if student.status != '–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ' %} ({{ student.status }}){% endif %}{% if not loop.last %}, {% endif %}
                            {% endfor %}
                        </p>
                        {% endif %}
                    </div>
                    
                    <!-- –ü—Ä–æ–≤–µ—Ä–∫–∞, –∑–∞–ø–∏—Å–∞–Ω –ª–∏ —É–∂–µ —Ç–µ–∫—É—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å -->
                    {% set is_registered = false %}
                    {% if item.students %}
                        {% for student in item.students %}
                            {% if student.student_id == user.id %}
                                {% set is_registered = true %}
                            {% endif %}
                        {% endfor %}
                    {% endif %}
                    
                    <div class="tutoring-actions">
                        {% if user.user_type == 'student' %}
                            {% if is_registered %}
                                <div class="registered-info">
                                    ‚úÖ –í—ã —É–∂–µ –∑–∞–ø–∏—Å–∞–Ω—ã
                                </div>
                            {% elif item.status in ['–ò–¥–µ—Ç –Ω–∞–±–æ—Ä', '–ï—Å—Ç—å –º–µ—Å—Ç–∞'] and (item.registered_count or 0) < item.max_students %}
                                <form action="/repetitorstvo/register/{{ item.id }}" method="POST">
                                    <button type="submit" class="btn btn-register">üìù –ó–∞–ø–∏—Å–∞—Ç—å—Å—è</button>
                                </form>
                            {% elif (item.registered_count or 0) >= item.max_students %}
                                <button class="btn btn-register" disabled>‚ùå –ù–µ—Ç –º–µ—Å—Ç</button>
                            {% elif item.status not in ['–ò–¥–µ—Ç –Ω–∞–±–æ—Ä', '–ï—Å—Ç—å –º–µ—Å—Ç–∞'] %}
                                <button class="btn btn-register" disabled>üö´ –ù–∞–±–æ—Ä –∑–∞–∫—Ä—ã—Ç</button>
                            {% endif %}
                        {% endif %}
                    </div>
                </div>
                {% endfor %}
            </div>
            {% else %}
            <div class="empty-message">
                üì≠ –°–µ–π—á–∞—Å –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∑–∞–Ω—è—Ç–∏–π –æ—Ç —Å—Ç—É–¥–µ–Ω—Ç–æ–≤
            </div>
            {% endif %}
        </div>

        <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∑–∞–ø–∏—Å–∏ -->
        <div class="info-box">
            <h3>üìù –ö–∞–∫ –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ –∑–∞–Ω—è—Ç–∏—è?</h3>
            <ul>
                <li>–í—ã–±–µ—Ä–∏—Ç–µ –∏–Ω—Ç–µ—Ä–µ—Å—É—é—â–∏–π –≤–∞—Å –ø—Ä–µ–¥–º–µ—Ç –∏–∑ —Å–ø–∏—Å–∫–∞ –≤—ã—à–µ</li>
                <li>–ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "–ó–∞–ø–∏—Å–∞—Ç—å—Å—è" –Ω–∞ –≤—ã–±—Ä–∞–Ω–Ω–æ–º —Ä–µ–ø–µ—Ç–∏—Ç–æ—Ä—Å—Ç–≤–µ</li>
                <li>–°—Ç–∞—Ç—É—Å –≤–∞—à–µ–π –∑–∞–ø–∏—Å–∏ –º–æ–∂–Ω–æ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤ —Ä–∞–∑–¥–µ–ª–µ "–ú–æ–∏ —Ä–µ–ø–µ—Ç–∏—Ç–æ—Ä—Å—Ç–≤–∞"</li>
                <li>–û–∂–∏–¥–∞–π—Ç–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –æ—Ç —Ä–µ–ø–µ—Ç–∏—Ç–æ—Ä–∞</li>
                <li>–°—Ç–æ–∏–º–æ—Å—Ç—å –∑–∞–Ω—è—Ç–∏–π —É–∫–∞–∑–∞–Ω–∞ –≤ –∫–∞—Ä—Ç–æ—á–∫–∞—Ö (–µ—Å—Ç—å –±–µ—Å–ø–ª–∞—Ç–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã)</li>
            </ul>
            <p style="margin-top: 15px; color: #666; font-size: 14px;">
                üí° <strong>–°–æ–≤–µ—Ç:</strong> –ó–∞–ø–∏—Å—ã–≤–∞–π—Ç–µ—Å—å –∑–∞—Ä–∞–Ω–µ–µ, —Ç–∞–∫ –∫–∞–∫ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–µ—Å—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–æ!
            </p>
        </div>
    </div>
</body>
</html>